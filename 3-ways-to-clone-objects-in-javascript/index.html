<meta charset="utf-8" />
    <meta content='text/html; charset=utf-8' http-equiv='Content-Type'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1.0'>

    
    <meta name="description" content="Cloning an object is somewhat a task that is almost always used in any project from a simple one to the most complicated ones.
As it may seem simple for not seasoned Javascript developers, it actually has some pitfalls that would hurt you in the bones if you didn’t know the proper way to do it.

" />
    <meta property="og:description" content="Cloning an object is somewhat a task that is almost always used in any project from a simple one to the most complicated ones.
As it may seem simple for not seasoned Javascript developers, it actually has some pitfalls that would hurt you in the bones if you didn’t know the proper way to do it.

" />
    

    <meta name="author" content="Farzad YZ" />

    
    <meta property="og:title" content="3 Ways to clone objects in Javascript" />
    <meta property="twitter:title" content="3 Ways to clone objects in Javascript" />
    
<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- <link rel="stylesheet" href="/assets/css/style.css"> -->
  
  <title>Farzad YZ personal blog</title>
  <link rel="icon" href="/images/favicon.png">
</head>

<body>
<main class="l-post">

  <section class="post__header" style="background-image: url(https://unsplash.it/1024/768/?random)">
    <a href="/" class="button button--outline button--white button--small button--rounded">&larr; Back</a>
    <section class="post container">
      <h1 class="post__title">
        3 Ways to clone objects in Javascript
      </h1>
      <date class="post__date post__date--large">01 Oct 2017</date>
    </section>
  </section>

  <section class="post__body">
    <article class="post container">
      <div class="post__entry">
        <p>Cloning an object is somewhat a task that is almost always used in any project from a simple one to the most complicated ones.
As it may seem simple for not seasoned Javascript developers, it actually has some pitfalls that would hurt you in the bones if you didn’t know the proper way to do it.</p>

<h2 id="talk-is-cheap-show-me-the-code">Talk is cheap, show me the code</h2>
<p>The first way that could cross a developer’s mind is to deeply iterate through source object’s properties and copy them one by one on the target object. As it may seem good at the beginning, it is not a performance friendly solution and a potential bottleneck when it comes to large and deep objects.</p>

<p><strong>1: Deep copy using iteration</strong></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">iterationCopy</span><span class="p">(</span><span class="nx">src</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">let</span> <span class="nx">target</span> <span class="o">=</span> <span class="p">{};</span>
  <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">prop</span> <span class="k">in</span> <span class="nx">src</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">src</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="nx">prop</span><span class="p">))</span> <span class="p">{</span>
      <span class="nx">target</span><span class="p">[</span><span class="nx">prop</span><span class="p">]</span> <span class="o">=</span> <span class="nx">src</span><span class="p">[</span><span class="nx">prop</span><span class="p">];</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="nx">target</span><span class="p">;</span>
<span class="p">}</span>
<span class="kd">const</span> <span class="nx">source</span> <span class="o">=</span> <span class="p">{</span><span class="na">a</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="na">b</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="na">c</span><span class="p">:</span><span class="mi">3</span><span class="p">};</span>
<span class="kd">const</span> <span class="nx">target</span> <span class="o">=</span> <span class="nx">iterationCopy</span><span class="p">(</span><span class="nx">source</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">target</span><span class="p">);</span> <span class="c1">// {a:1, b:2, c:3}</span>
<span class="c1">// Check if clones it and not changing it</span>
<span class="nx">source</span><span class="p">.</span><span class="nx">a</span> <span class="o">=</span> <span class="s1">'a'</span><span class="p">;</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">source</span><span class="p">.</span><span class="nx">a</span><span class="p">);</span> <span class="c1">// 'a'</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">target</span><span class="p">.</span><span class="nx">a</span><span class="p">);</span> <span class="c1">// 1</span>
</code></pre></div></div>
<p>So as you see, it’s working!
Now let’s cut the chase to the second solution which is indeed more elegant.</p>

<p><strong>2: Converting to JSON and back</strong></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">jsonCopy</span><span class="p">(</span><span class="nx">src</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">src</span><span class="p">));</span>
<span class="p">}</span>
<span class="kd">const</span> <span class="nx">source</span> <span class="o">=</span> <span class="p">{</span><span class="na">a</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="na">b</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="na">c</span><span class="p">:</span><span class="mi">3</span><span class="p">};</span>
<span class="kd">const</span> <span class="nx">target</span> <span class="o">=</span> <span class="nx">jsonCopy</span><span class="p">(</span><span class="nx">source</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">target</span><span class="p">);</span> <span class="c1">// {a:1, b:2, c:3}</span>
<span class="c1">// Check if clones it and not changing it</span>
<span class="nx">source</span><span class="p">.</span><span class="nx">a</span> <span class="o">=</span> <span class="s1">'a'</span><span class="p">;</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">source</span><span class="p">.</span><span class="nx">a</span><span class="p">);</span> <span class="c1">// 'a'</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">target</span><span class="p">.</span><span class="nx">a</span><span class="p">);</span> <span class="c1">// 1</span>
</code></pre></div></div>

<blockquote>
  <p>Note: Be careful about using this method as your source object MUST be JSON safe. So it may need some sort of exception handling to keep it safe in cases in which the source object is not convertible to JSON.</p>
</blockquote>

<p><strong>3: Using <code class="highlighter-rouge">Object.assign</code></strong></p>

<blockquote>
  <p>Update: This method has a flaw that it only does a shallow copy. It means that nested properties are still going to be copied by reference. Be careful about it.</p>
</blockquote>

<p>This way is the best and the safest way I personally consume in my projects.It’s leveraging a built-in static method on the Object object and is handled and provided by the language. So use this one!</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">bestCopyEver</span><span class="p">(</span><span class="nx">src</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">assign</span><span class="p">({},</span> <span class="nx">src</span><span class="p">);</span>
<span class="p">}</span>
<span class="kd">const</span> <span class="nx">source</span> <span class="o">=</span> <span class="p">{</span><span class="na">a</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="na">b</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="na">c</span><span class="p">:</span><span class="mi">3</span><span class="p">};</span>
<span class="kd">const</span> <span class="nx">target</span> <span class="o">=</span> <span class="nx">bestCopyEver</span><span class="p">(</span><span class="nx">source</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">target</span><span class="p">);</span> <span class="c1">// {a:1, b:2, c:3}</span>
<span class="c1">// Check if clones it and not changing it</span>
<span class="nx">source</span><span class="p">.</span><span class="nx">a</span> <span class="o">=</span> <span class="s1">'a'</span><span class="p">;</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">source</span><span class="p">.</span><span class="nx">a</span><span class="p">);</span> <span class="c1">// 'a'</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">target</span><span class="p">.</span><span class="nx">a</span><span class="p">);</span> <span class="c1">// 1</span>
</code></pre></div></div>

<h2 id="conclusion">Conclusion</h2>

<p>You must know that every framework and including libraries such as Lodash and Underscore has a way to support cloning objects. Almost all of them used a more complex version of iterationCopy before ES6 was introduced. On ES6+ environments, there is language support for <code class="highlighter-rouge">Object.assign</code> , so try to use the most out of it. As a rule of thumb, always try to use the 3rd solution and avoid the JSON solution.
Keep calm and clone objects without any hesitation :)</p>

      </div>
    </article>
  </section>

</main>

<div class="container">
  <div class="row post__siblings">
    
      <a class="button button--outline" href="/Handling-lodings-in-react-using-higher-order-components/">&larr; Handling loadings in React using Higher Order Components</a>
    
    
      <a class="button button--outline" href="/Unit-testing-higher-order-components-using-enzyme/">Unit testing Higher Order Components using Enzyme &rarr;</a>
    
  </div>
</div>

<section class="post__footer container">
  <div class="row">
    <div class="col--3 text--center">
      <div class="hero__avatar avatar avatar--circle"></div>
    </div>
    <div class="col--9">
      <h3 class="post__footer__title">Farzad YZ</h3>
      <p class="post__footer__entry">
        Javascript enthusiast, blogger, astronomer
      </p>
      <a href="/about" class="button button--fill button--small button--rounded">More about me</a>
    </div>
  </div>
</section>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-104117544-1', 'auto');
  ga('send', 'pageview');

</script>
<script src="https://ajax.googleapis.com/ajax/libs/webfont/1.5.18/webfont.js"></script>
<script>
  WebFont.load({
    google: {
      families: ['Open Sans Condensed:300,300italic,700', 'Merriweather:300,300italic,400,italic,700,700italic', 'Open Sans:300,300italic,400,italic,600,600italic,700,700italic', 'Overpass Mono']
    }
  });

</script>
 <script src="/assets/site-1778c2a687e031eca121a38276054984eee6654585660db2bff6a212665d5341.js" type="text/javascript"></script>
</body>

</html>